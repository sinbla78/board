# @Vaild(유형성검사)

- 유효성 검사란?

> 요청한 데이터가 어떤 조건에 충족하는지 확인하는 작업이다.
>
> 데이터의 값이 유효한지, 조건에 타당한지 확인하는 것을 말한다.
>
> 올바르지 않은 데이터를 서버 또는 DB로 전송되는것을 막기 위함이다.

- 예를 들어서, 회원가입을 할떄 생년월일을 작성하는 상황이라고 가정하자

- 클라이언트가 서버로 요청을 보낼때  생년월일은 '2023-04-05'이러한 형식으로 요창이 되어야한다.

- '2023-13-13', '2023-02-31'과 같은 날짜는 존재하지 않는다.

- 따라서, 잘못된 데이터 요청이 데이터 요청이 들어 올 경우 유효성 검사를 통하여 처리해주어야한다.

- 유효성 검사는 프론트와 백엔드 모두 다 해야 한다. 프론트에서만 유효성을 검사를 하는 것은 보안상 위험이 존재하기 때문에, 백엔드에서도 유효성 검사를 해야 한다.

- #### 스프링부트에서 DTO의 필드 조건과, 메시지를 작성해주면 @Valid 어노테이션과 함께 유효성 검사를 할 수 있다.

- (* DTO란? )

  - 데이터 전달 객체
  - 클라이언트의 요청 데이터가 dto 클래스로 캡슐화 되어서 서버로 전달
  - 컨트롤러 <-> 서비스 계층 간 데이터 전달

### 유효성 에러에 대한 Response 상태코드

> 유효성 에러에 대한 권장 상태코드는 400- BAD REQUEST이다.

------

# @Transactional

- ## 1. 정의

  > 데이터베이스 관리 시스템 또는 유사한 시스템에서 상호작용의 단위이다. 여기서 유사한 시스템이란 트랜잭션이 성공과 실패가 분명하고 상호 독립적이며, 일관되고 믿을 수 있는 시스템을 의미한다. 데이터의 정합성을 보장하기 위해 고안된 방법이다.

  ### 목적

  - 오류로부터 복구를 허용하고 데이터베이스를 일관성있게 유지하는 안정적인 작업 단위를 제공한다.
  - 동시 접근하는 여러 프로그램 간 격리를 제공한다

  ## 2. ACID

  > 이론적으로 데이터베이스 시스템은 각각의 트랜잭션에 대해 원자성(`Atomicity`), 일관성(`Consistency`), 독립성(`Isolation`), 영구성(`Durability`)을 보장한다. 이 성질을 첫글자를 따 [ACID]라 부른다.

  - 원자성(Atomicity) : 트랜잭션이 완전히 성공하거나 완전히 실패하는 단일 단위로 처리되도록 보장하는 능력이다. 중간 단계까지 실행되고 실패하는 일이 없도록 하는 것이다.
  - `일관성(Consistency)`: 각 데이터 트랜잭션이 데이터베이스를 일관성 있는 상태에서 일관성 있는 상태로 이동해야 함을 의미한다. 즉 트랜잭션이 성공적으로 완료하면 언제나 동일한 데이터베이스 상태로 유지하는 것을 의미한다.
  - `독립성(Isolation)`: 트랜잭션을 수행 시 다른 트랜잭션의 연산 작업이 끼어들지 못하도록 보장하는 것을 의미한다. 이것은 트랜잭션 밖에 있는 어떤 연산도 중간 단계의 데이터를 볼 수 없음을 의미한다. 여러 트랜잭션이 동시에 발생하는 경우 최종 상태는 트랜잭션이 개별적으로 발생한 것과 같아야 한다. 즉, 데이터베이스는 스트레스 테스트를 통과해야 한다. 즉, 과부하로 인해 잘못된 데이터베이스 트랜잭션이 발생하지 않아야 한다.
  - `지속성(Durability)` : 성공적으로 수행된 트랜잭션은 영원히 반영(기록)되어야 함을 의미한다. 트랜잭션은 로그에 모든 것이 저장된 후에만 commit 상태로 간주될 수 있다. 데이터베이스 내의 데이터는 트랜잭션의 결과로만 변경되어야 하며 외부 영향에 의해 변경될 수 없어야 한다. 예를 들어 소프트웨어 업데이트로 인해 데이터가 실수로 변경되거나 삭제되지 않아야 한다.

# @PathVariable

- @PathVariable은 스프링 프레임워크에서 제공하는 어노테이션 중 하나로, RESTful 웹 애플리케이션에서 URL 경로의 일부를 매개변수로 받아와서 처리할 수 있도록 도와줍니다.
- 예를 들어, "/users/{id}"와 같은 URL 경로가 있다면, @PathVariable 어노테이션을 이용해서 "id" 부분을 매개변수로 받아와서 해당하는 사용자 정보를 조회하거나 삭제하는 등의 작업을 수행할 수 있습니다.
- @PathVariable 어노테이션을 사용하면 URL 경로의 일부를 동적으로 처리할 수 있어서, RESTful 웹 애플리케이션에서 유용하게 사용됩니다.

# @RequestParam

- @RequestParam은 스프링 프레임워크에서 제공하는 어노테이션 중 하나로, HTTP 요청 파라미터를 메서드의 매개변수로 받아올 때 사용됩니다.
- 예를 들어, GET 방식으로 "/search?q=spring"과 같은 요청이 들어왔다면, @RequestParam 어노테이션을 이용해서 "q"라는 이름의 파라미터 값을 메서드의 매개변수로 받아와서 해당하는 검색어로 검색을 수행할 수 있습니다.
- @RequestParam 어노테이션은 기본적으로 필수 파라미터인 경우 해당 파라미터가 누락되면 예외를 발생시키지만, required 속성을 false로 지정하여 선택적 파라미터로 설정할 수도 있습니다.
- @RequestParam 어노테이션은 HTTP 요청 파라미터를 메서드의 매개변수로 간단하게 바인딩할 수 있어서, 웹 애플리케이션에서 많이 사용됩니다.

# @.orElseThrow()

- `.orElseThrow()` 메서드는 자바 8에서 추가된 Optional 클래스의 메서드 중 하나로, Optional 객체에 값이 존재하면 해당 값을 반환하고, 값이 존재하지 않으면 지정된 예외를 던지는 기능을 제공합니다.

  ```
  Optional<String> optionalString = Optional.ofNullable(getString());
  String str = optionalString.orElseThrow(() -> new RuntimeException("String is null"));
  ```

  위의 코드에서, `Optional.ofNullable()` 메서드를 사용하여 nullable한 문자열을 Optional 객체로 변환합니다. 그리고 `orElseThrow()` 메서드를 사용하여 문자열이 null이면 `RuntimeException`을 던지고, 그렇지 않으면 Optional 객체에서 문자열 값을 반환합니다.

  이렇게 사용하면 코드가 보다 명확해지고, null 값을 처리하는 방법에 대한 일관성을 유지할 수 있습니다.

# @어노테이션

- @NotNull - 속성 값이 Null이 아닌지 확인.
- @AssertTrue - 주석이 달린 속성 값이 true 인지 확인.
- @Size - 속성 값이 속성 min과 max 사이의 크기 인지 확인.( String, Collection, Map, 배열 속성에 적용할수 있음)
- @Min - 속성값이 value값보다 작지 않은지 확인.
- @Max - 속성값이 value값보다 크지 않은지 확인.
- @Email - 속성값이 유효한 이메일주소 인지 확인.
- @NotEmpty - 속성값이 null 또는 비어 있지 않은지 확인.(String,Collection,Map,Array값에만 적용)
- @NotBlank- 텍스트 값에만 적용할 수 있으며 속성이 null 또는 공백이 아닌지 확인.
- @Positive 및 @PositiveOrZero - 숫자값에만 적용되며 값이 양수인지 또는 0을 포함하여 양수인지 확인
- @Negative 및 @NegativeOrZero - 숫자값에만 적용되며 값이 음수인지 또는 0을 포함하여 음수인지 확인
- @Past 및 @PastOrPresent 날짜 값이 현재를 포함하여 과거인지 또는 과거인지 확인 (LocalDate, LocalDateTime에 적용)
- @Future 및 @FutureOrPresent 날짜 값이 미래인지 또는 현재를 포함한 미래인지 확인

# 차이점

- @PathVariable과 @RequestParam은 모두 스프링 프레임워크에서 제공하는 어노테이션으로, HTTP 요청에서 파라미터를 받아오는 기능을 수행합니다. 그러나 둘의 차이점은 다음과 같습니다.

  1. 사용하는 위치

  - @PathVariable은 URL 경로의 일부를 매개변수로 받아오는데 사용되며, @RequestParam은 HTTP 요청 파라미터를 매개변수로 받아오는데 사용됩니다.

  1. 파라미터 이름

  - @PathVariable은 URL 경로에서 매개변수 이름을 지정할 수 있지만, @RequestParam은 요청 파라미터의 이름을 지정해야 합니다.

  1. 필수 여부

  - @PathVariable은 경로 변수이므로 필수적으로 값을 가져와야 합니다. 따라서, 값을 못 가져올 경우 404 오류가 발생합니다. 반면, @RequestParam은 기본적으로 필수적이지 않으며, 필수적으로 지정할 수 있습니다.

  1. 데이터 타입

  - @PathVariable은 URL 경로에서 가져오는 값이 문자열이므로, 해당 매개변수의 타입을 문자열로 지정해야 합니다. 반면, @RequestParam은 HTTP 요청 파라미터의 값이 문자열이 아닐 수도 있으므로, 해당 매개변수의 타입을 자동으로 변환할 수 있습니다.

따라서, @PathVariable은 경로에서 매개변수를 받아오고, @RequestParam은 요청 파라미터를 받아오는데 사용된다.

